######


set path [format "%s%s"  $ip_parent_path $f_sys_bdname]

create_project $f_sys_bdname $path -part xc7k70tfbv676-1

set_property target_language VHDL [current_project]

set_property  ip_repo_paths  $allsystempath [current_project]

update_ip_catalog

#创建bd文件并命名

create_bd_design "$f_sys_bdname"

update_compile_order -fileset sources_1





#在bd文件中导入该分系统包含的原子系统或分系统和数据存储

for {set j [llength $f_all_ipname]} {$j>0} {incr j -1} {

    startgroup

    set bd_ip_name [format "%s_0" [lindex $f_all_ipname [expr $j-1]]]

    create_bd_cell -type ip -vlnv xilinx.com:user:[lindex $f_all_ipname [expr $j-1]]:1.0 $bd_ip_name

    endgroup

}




for {set m [llength $netconnect]} {$m>0} {incr m -2} {
            set port_net1 [lindex $netconnect [expr $m-1]]
            set port_net2 [lindex $netconnect [expr $m-2]]
            connect_bd_net [get_bd_pins $port_net1] [get_bd_pins $port_net2]
}


for {set n [llength $f_all_ipname]} {$n>0} {incr n -1} {



    startgroup

    set ip_external [format "%s_0" [lindex $f_all_ipname [expr $n-1]]]

    make_bd_pins_external  [get_bd_cells $ip_external]

    endgroup

}

save_bd_design

make_wrapper -files [get_files $wrappers ] -top

add_files -norecurse $norecurses

ipx::package_project -root_dir $ippackages -vendor xilinx.com -library user -taxonomy /UserIP