set netconnect "MR_0/in_MSM_MR_Curr_mode_load_inst MSM19_0/out_MSM_MR_Curr_mode_load_inst MSM19_0/in_MSM_MR_Curr_mode_work_time MR_0/out_MSM_MR_Curr_mode_work_time MR_0/in_MSM_MR_Curr_mode_work_time MSM19_0/out_MSM_MR_Curr_mode_work_time MR_0/in_MSM_MR_Targ_angl_stor_inst MSM19_0/out_MSM_MR_Targ_angl_stor_inst MR_0/in_MSM_MR_Targ_angu_velo MSM19_0/out_MSM_MR_Targ_angu_velo MR_0/in_MSM_MR_Targ_angl MSM19_0/out_MSM_MR_Targ_angl MR_0/in_MSM_MR_Curr_mode_work_time_load_inst MSM19_0/out_MSM_MR_Curr_mode_work_time_load_inst MR_0/in_MSM_MR_Next_cycl_mode MSM19_0/out_MSM_MR_Next_cycl_mode MR_0/in_MSM_MR_Curr_mode_work_time_stor_inst MSM19_0/out_MSM_MR_Curr_mode_work_time_stor_inst MR_0/in_MSM_MR_Targ_angu_velo_stor_inst MSM19_0/out_MSM_MR_Targ_angu_velo_stor_inst MR_0/in_MSM_MR_Next_cycl_mode_stor_inst MSM19_0/out_MSM_MR_Next_cycl_mode_stor_inst TP22_0/in_TP_MR_Curr_mode MR_0/out_TP_MR_Curr_mode AD18_0/in_AD_MR_Curr_mode MR_0/out_AD_MR_Curr_mode TCC20_0/in_TCC_MR_Targ_angl MR_0/out_TCC_MR_Targ_angl TCC20_0/in_TCC_MR_Targ_angu_velo MR_0/out_TCC_MR_Targ_angu_velo MSM19_0/in_MSM_MR_Curr_mode MR_0/out_MSM_MR_Curr_mode TTC23_wrapper_0/in_TTI_TTI_Tria_cont_inst_0 TTC23_wrapper_0/out_TTI_TTI_Tria_cont_inst_0 I1_wrapper_0/in_SSCO_SSI_Sun_sens_powe_on_inst_0_0 SSI_0/out_SSCO_SSI_Sun_sens_powe_on_inst GI_0/in_GCO_GI_Gyro_powe_on_inst_load_inst I1_wrapper_0/out_GCO_GI_Gyro_powe_on_inst_load_inst_0_0 MR_0/in_MI_MR_Curr_mode I1_wrapper_0/out_MI_MR_Curr_mode_0 MR_0/in_MI_MR_Curr_mode_stor_inst I1_wrapper_0/out_MI_MR_Curr_mode_stor_inst_0 GI_0/in_SGPo_GI_Gyro_powe_on_inst I1_wrapper_0/out_SGPo_GI_Gyro_powe_on_inst_0_0 GI_0/in_SGPo_GI_Gyro_powe_on_inst_stor_inst I1_wrapper_0/out_SGPo_GI_Gyro_powe_on_inst_stor_inst_0_0 SSI_0/in_SSCO_SSI_Sun_sens_powe_on_inst_load_inst I1_wrapper_0/out_SSCO_SSI_Sun_sens_powe_on_inst_load_inst_0_0 SSI_0/in_SSSP_SSI_Sun_sens_powe_on_inst I1_wrapper_0/out_SSSP_SSI_Sun_sens_powe_on_inst_0_0 SSI_0/in_SSSP_SSI_Sun_sens_powe_on_inst_stor_inst I1_wrapper_0/out_SSSP_SSI_Sun_sens_powe_on_inst_stor_inst_0_0 TPI_0/in_STPo_TPI_Thru_powe_on_inst I1_wrapper_0/out_STPo_TPI_Thru_powe_on_inst_0_0 TPI_0/in_STPo_TPI_Thru_powe_on_inst_stor_inst I1_wrapper_0/out_STPo_TPI_Thru_powe_on_inst_stor_inst_0_0 TPI_0/in_TPCO_TPI_Thru_powe_on_inst_load_inst I1_wrapper_0/out_TPCO_TPI_Thru_powe_on_inst_load_inst_0_0 TTC23_wrapper_0/in_TDCR_TDCR_Thru_comb_logi_0 TDC21_0/out_TDCR_TDCR_Thru_comb_logi MR_0/in_TP_MR_Curr_mode_load_inst TP22_0/out_TP_MR_Curr_mode_load_inst AD18_0/in_GD_GD_Angu_velo_anal DA14_wrapper_0/out_GD_GD_Angu_velo_anal_0 AD18_0/in_SSD_SSD_Sun_meas_angl DA14_wrapper_0/out_SSD_SSD_Sun_meas_angl_0 MSM19_0/in_SSD_SSD_Sun_visi_sign DA14_wrapper_0/out_SSD_SSD_Sun_visi_sign_0 AD18_0/in_SSD_SSD_Sun_visi_sign DA14_wrapper_0/out_SSD_SSD_Sun_visi_sign_0 TDC21_0/in_TD_TD_Thru_powe_stat DA14_wrapper_0/out_TD_TD_Thru_powe_stat_0 I1_wrapper_0/in_GCO_GI_Gyro_powe_on_inst_0_0 GI_0/out_GCO_GI_Gyro_powe_on_inst MR_0/in_TIP_MR_Next_cycl_mode_stor_inst TIP13_0/out_TIP_MR_Next_cycl_mode_stor_inst MR_0/in_TIP_MR_Next_cycl_mode TIP13_0/out_TIP_MR_Next_cycl_mode TDC21_0/in_CCR_CCR_Tria_cont_quan TCC20_0/out_CCR_CCR_Tria_cont_quan MR_0/in_TCC_MR_Targ_angu_velo_load_inst TCC20_0/out_TCC_MR_Targ_angu_velo_load_inst MR_0/in_TCC_MR_Targ_angl_load_inst TCC20_0/out_TCC_MR_Targ_angl_load_inst MSM19_0/in_ADR_ADR_Tria_angu_velo AD18_0/out_ADR_ADR_Tria_angu_velo TP22_0/in_ADR_ADR_Tria_angu_velo AD18_0/out_ADR_ADR_Tria_angu_velo TCC20_0/in_ADR_ADR_Tria_angu_velo AD18_0/out_ADR_ADR_Tria_angu_velo MR_0/in_AD_MR_Curr_mode_load_inst AD18_0/out_AD_MR_Curr_mode_load_inst MSM19_0/in_ADR_ADR_Tria_atti_angl AD18_0/out_ADR_ADR_Tria_atti_angl TP22_0/in_ADR_ADR_Tria_atti_angl AD18_0/out_ADR_ADR_Tria_atti_angl TCC20_0/in_ADR_ADR_Tria_atti_angl AD18_0/out_ADR_ADR_Tria_atti_angl I1_wrapper_0/in_TPCO_TPI_Thru_powe_on_inst_0_0 TPI_0/out_TPCO_TPI_Thru_powe_on_inst "
set f_sys_ipname [split "I1_wrapper,TIP13,DA14_wrapper,AD18,MSM19,TCC20,TDC21,TP22,TTC23_wrapper" ","]
set f_all_ipname [split "MSM19,MR,TTC23_wrapper,SSI,I1_wrapper,TDC21,TP22,DA14_wrapper,GI,TIP13,TCC20,AD18,TPI" ","]
set f_clk_portname [split "I1_wrapper_0/clk_0,TIP13_0/clk,DA14_wrapper_0/clk_0,AD18_0/clk,MSM19_0/clk,TCC20_0/clk,TDC21_0/clk,TP22_0/clk,TTC23_wrapper_0/clk_0" ","]
set f_rst_portname [split "I1_wrapper_0/rst_0,TIP13_0/rst,DA14_wrapper_0/rst_0,AD18_0/rst,MSM19_0/rst,TCC20_0/rst,TDC21_0/rst,TP22_0/rst,TTC23_wrapper_0/rst_0" ","]
set f_done_portname [split "I1_wrapper_0/done_0,TIP13_0/done,DA14_wrapper_0/done_0,AD18_0/done,MSM19_0/done,TCC20_0/done,TDC21_0/done,TP22_0/done,TTC23_wrapper_0/done_0" ","]
set f_start_portname [split "I1_wrapper_0/start_0,TIP13_0/start,DA14_wrapper_0/start_0,AD18_0/start,MSM19_0/start,TCC20_0/start,TDC21_0/start,TP22_0/start,TTC23_wrapper_0/start_0" ","]
set wrappers "./AtomicSystemGeneration/SubSystemProject/SSS0/SSS0.srcs/sources_1/bd/SSS0/SSS0.bd"
set norecurses "./AtomicSystemGeneration/SubSystemProject/SSS0/SSS0.gen/sources_1/bd/SSS0/hdl/SSS0_wrapper.vhd"
set ippackages "./AtomicSystemGeneration/SubSystemProject/SSS0"
set f_sys_bdname "SSS0"
set f_sys_controlers "SSS0Dependency"
set ip_parent_path "./AtomicSystemGeneration/SubSystemProject/"
set allsystempath "./AtomicSystemGeneration"
######





set path [format "%s%s"  $ip_parent_path $f_sys_bdname]



create_project $f_sys_bdname $path -part xc7k70tfbv676-1



set_property target_language VHDL [current_project]



set_property  ip_repo_paths  $allsystempath [current_project]



update_ip_catalog



#创建bd文件并命名



create_bd_design "$f_sys_bdname"



update_compile_order -fileset sources_1



#在bd文件中导入分控制器IP



startgroup



set bd_ipc_name [format "%s_0" $f_sys_controlers]



#bd_ipc_name=f_sys_controlers+_0 (InitializationControl_0=InitializationControl+_0)



create_bd_cell -type ip -vlnv xilinx.com:user:$f_sys_controlers:1.0 $bd_ipc_name



endgroup







#在bd文件中导入该分系统包含的原子系统或分系统和数据存储



for {set j [llength $f_all_ipname]} {$j>0} {incr j -1} {



    startgroup



    set bd_ip_name [format "%s_0" [lindex $f_all_ipname [expr $j-1]]]



    create_bd_cell -type ip -vlnv xilinx.com:user:[lindex $f_all_ipname [expr $j-1]]:1.0 $bd_ip_name



    endgroup



}



startgroup



set clk [format "%s/clk" $bd_ipc_name]



make_bd_pins_external  [get_bd_pins $clk]



endgroup



startgroup



set rst [format "%s/rst" $bd_ipc_name]



make_bd_pins_external  [get_bd_pins $rst]



endgroup



startgroup



set done [format "%s/done" $bd_ipc_name]



make_bd_pins_external  [get_bd_pins $done]



endgroup



startgroup



set start [format "%s/start" $bd_ipc_name]



make_bd_pins_external  [get_bd_pins $start]



endgroup



for {set k [llength $f_clk_portname]} {$k>0} {incr k -1} {







    set connect_clk [format "%s" [lindex $f_clk_portname [expr $k-1]]]



    connect_bd_net [get_bd_ports clk_0] [get_bd_pins $connect_clk]







}



for {set k [llength $f_rst_portname]} {$k>0} {incr k -1} {











    set connect_rst [format "%s" [lindex $f_rst_portname [expr $k-1]]]



    connect_bd_net [get_bd_ports rst_0] [get_bd_pins $connect_rst]















}



for {set k [llength $f_start_portname]} {$k>0} {incr k -1} {















    set connect_start_a [format "%s" [lindex $f_start_portname [expr $k-1]]]



    set connect_start_b [format "%s/start%d" $bd_ipc_name [expr $k-1]]



    connect_bd_net [get_bd_pins $connect_start_b] [get_bd_pins $connect_start_a]







}



for {set k [llength $f_done_portname]} {$k>0} {incr k -1} {















    set connect_done_a [format "%s" [lindex $f_done_portname [expr $k-1]]]



    set connect_done_b [format "%s/done%d" $bd_ipc_name [expr $k-1]]



    connect_bd_net [get_bd_pins $connect_done_b] [get_bd_pins $connect_done_a]







}

for {set m [llength $netconnect]} {$m>0} {incr m -2} {

            set port_net1 [lindex $netconnect [expr $m-1]]

            set port_net2 [lindex $netconnect [expr $m-2]]

            connect_bd_net [get_bd_pins $port_net1] [get_bd_pins $port_net2]

}





for {set n [llength $f_all_ipname]} {$n>0} {incr n -1} {







    startgroup



    set ip_external [format "%s_0" [lindex $f_all_ipname [expr $n-1]]]



    make_bd_pins_external  [get_bd_cells $ip_external]



    endgroup



}



save_bd_design



make_wrapper -files [get_files $wrappers ] -top



add_files -norecurse $norecurses



ipx::package_project -root_dir $ippackages -vendor xilinx.com -library user -taxonomy /UserIP
